Report 50535 "Payroll Employee Loans"
{
    RDLCLayout = 'Layouts/PayrollEmployeeLoans.rdlc';
    DefaultLayout = RDLC;

    dataset
    {
        dataitem("Payroll Employee Transactions."; "Payroll Employee Transactions.")
        {
            column(ReportForNavId_1000000000; 1000000000) { } // Autogenerated by ForNav - Do not delete
            trigger OnPreDataItem();
            begin
                //LoanType:='';
            end;

            trigger OnAfterGetRecord();
            begin
                Loans.Reset;
                Loans.SetRange(Loans."Client Code", "Payroll Employee Transactions."."No.");
                if Loans.Find('-') then begin
                    repeat
                        //IF Loans.Deductible=TRUE THEN  BEGIN
                        Loans.CalcFields(Loans."Outstanding Balance");
                        if Loans."Outstanding Balance" > 0 then begin
                            LoanType := Loans."Loan Product Type";
                            // IF "Payroll Employee Transactions."."Loan Number"<>Loans."Loan  No." THEN
                            Transaction.Reset;
                            Transaction.SetRange(Transaction."Transaction Type", Transaction."transaction type"::Deduction);
                            Transaction.SetRange(Transaction."Loan Product", LoanType);
                            if Transaction.Find('-') then begin
                                TCode := Transaction."Transaction Code";
                                Tname := Transaction."Transaction Name";
                                TType := Transaction."Transaction Type";
                                "Payroll Employee Transactions.".Init;
                                "Payroll Employee Transactions."."No." := Loans."Client Code";
                                "Payroll Employee Transactions."."Sacco Membership No." := Loans."Client Code";
                                "Payroll Employee Transactions."."Transaction Code" := TCode;
                                "Payroll Employee Transactions."."Transaction Name" := Tname;
                                "Payroll Employee Transactions."."Transaction Type" := TType;
                                "Payroll Employee Transactions."."Loan Number" := Loans."Loan  No.";
                                "Payroll Employee Transactions."."Period Month" := 10;
                                "Payroll Employee Transactions."."Period Year" := 2016;
                                "Payroll Employee Transactions.".Insert;
                            end;
                        end;
                    until Loans.Next = 0;
                    //END;
                end;
                //ELSE
                //CurrReport.SKIP;
            end;

        }
    }

    requestpage
    {


        SaveValues = false;
        layout
        {
            area(content)
            {
                group(Options)
                {
                    Caption = 'Options';

                }
            }
        }

        actions
        {
        }
        trigger OnOpenPage()
        begin

        end;
    }

    trigger OnInitReport()
    begin
        ;


    end;

    trigger OnPostReport()
    begin
        ;

    end;

    trigger OnPreReport()
    begin
        ;

    end;

    var
        Loans: Record "Loans Register";
        Transaction: Record "Payroll Transaction Code.";
        LoanType: Code[30];
        TCode: Code[30];
        Tname: Text;
        TType: Option Income,Deduction;
        LoanSetup: Record "Loan Products Setup";
        Deductable: Boolean;

    var
}
